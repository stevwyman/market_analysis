{% extends "data/layout.html" %}
{% load static %}

{% block body %}

<section class="py-5 text-center container">
  <h1>{{ security.name }}</h1>
  <span class="fs-2 ms-2">{{ price.currency_symbol }}&nbsp;{{ price.price|floatformat:2 }}</span>
  <span class="fs-4 ms-2 {% if price.change > 0 %} text-success fw-light {% else %} text-danger {% endif %}">{{ price.change|floatformat:2 }}&nbsp;({{ price.change_percent|floatformat:2 }}%)</span>
  <span class="fs-6 ms-2 fw-light">{% load humanize %}{{ price.local_timestamp|naturaltime }}</span>
</section>

{% csrf_token %}

<div class="container">

	<div class="row">
		<div class="col col-md-8">
			<div class="py-2">
				<ul class="nav nav-tabs">
					<li class="nav-item">
						<a class="nav-link" id="nl_daily" onClick="show_history('{{ security.id }}', 'd')" href="#">Daily</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" id="nl_weekly" onClick="show_history('{{ security.id }}', 'w')" href="#">Weekly</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" id="nl_monthly" onClick="show_history('{{ security.id }}', 'm')" href="#">Monthly</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" id="nl_hurst" onClick="show_tp('{{ security.id }}', 'hurst')" href="#">Hurst</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" id="nl_sd" onClick="show_tp('{{ security.id }}', 'sd')" href="#">SD</a>
					</li>
				  </ul>
			</div>
			<div id="chartContainer"></div>
			<div id="chartHeader"></div>
		</div>
		<div class="col col-md-4">
			<div class="py-2">
				<ul class="nav nav-tabs">
					<li class="nav-item">
					  <a class="nav-link active" aria-current="page" href="#">fundamental</a>
					</li>
					<li class="nav-item">
					  <a class="nav-link" href="#">Technical</a>
					</li>
				  </ul>
			</div>
			<div>
				{% if not defaultKeyStatistics.vars %}
				not defaultKeyStatistics
				{% endif %}

				<table class="table">
					<tr>
						<td>PE<sub>forward</sub></td>
						<td>{{ defaultKeyStatistics.forwardPE.raw|floatformat:2 }}</td>
					</tr>
					<tr>
						<td>PEG</td>
						<td>{{ defaultKeyStatistics.pegRatio.raw|floatformat:2 }}</td>
					</tr>
					<tr>
						<td>EV/rev</td>
						<td>{{ defaultKeyStatistics.enterpriseToRevenue.raw|floatformat:2 }}</td>
					</tr>
					<tr>
						<td>EV/Ebitda</td>
						<td>{{ defaultKeyStatistics.enterpriseToEbitda.raw|floatformat:2 }}</td>
					</tr>
					<tr>
						<td>Short/Float<br><small>{{ defaultKeyStatistics.dateShortInterest.fmt }}</small></td>
						<td>{{ defaultKeyStatistics.shortPercentOfFloat.fmt }}</td>
					</tr>
				</table>
				
			</div>
		</div>
		
	</div>
	
  	<div class="row bg-light py-5">
		<div>
			<a href="{% url 'history_update' security.id %}?interval=1d">update daily</a>
	  	</div>
		<div>
			<a href="{% url 'history_update' security.id %}?interval=1w">update weekly</a>
	  	</div>
		<div>
			<a href="{% url 'history_update' security.id %}?interval=1mo">update monthly</a>
	  	</div>
	</div>
</div>

<div class="container">
	<ul>
		{% for key, value in defaultKeyStatistics.items %} 
		<li>{{key}} - {{value}}</li>
		{% endfor %}
	</ul>
</div>






<script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>

<script>
	show_history('{{ security.id }}', 'd')
</script>


{% endblock %}